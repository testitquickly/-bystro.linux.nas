Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2023-02-03T16:55:44+02:00

====== Про ssh ======

Secure shell (SSH) — наш основной способ коннекта на удалённый компьютер в консоли. В современных дистрибутивах этот сервис включен по-умолчанию, его надо лишь дополнительно обезопасить.

Ничто не сравнится со своим, личным, сделанным своими личными руками личным ssh-ключом. Гарантируется глубочайшее ложное ощущение полной безопасности.

===== Софт для подключения =====

В мире виндовс быстро привыкаешь к приложению ’PuTTY’, это в принципе ещё одна консоль, там можно очень много чего настроить и подключаться не только по ssh. В Linux это ’PuTTY’ тоже есть, но (почти) всё то же самое делается через обычную консоль.

	Если неймется: 
	
	''aptitude install putty && putty &''

===== Основы подключения =====

При первом подключении к серверу по ssh всегда происходит автообмен ключами. Это выглядит так:

''ssh login@192.168.1.20''
''The authenticity of host ’192.168.1.20(192.168.1.20)’ can’t be established.''
''ECDSA key fingerprint is SHA256:kMUX (и так далее).''
''Are you sure you want to continue connecting (yes/no/[fingerprint])? ='' 

Надо набрать на клавиатуре «Yes». В ответ будет последнее ~~китайское~~ предупреждение:

''Warning: Permanently added ’192.168.1.20’ (ECDSA) to the list of known hosts.''

На этом можно было бы остановиться, но лучше сгенерировать личный ssh-ключ и делать аутентификацию по нему. Каждый коннект будет происходить в автоматическом режиме с повышенным уровнем безопасности. Пока этот ключ не украдут со всем папкой ’∼/.ssh’, конечно.

Свой публичный ssh-ключ можно использовать на нескольких серверах и на GitHub одновременно, главное — сохранять в секрете приватный ключ, вероятно даже на флэшке, вероятно даже внутри себя. 

	Формально, [[https://askubuntu.com/a/115323|можно]] заходить на NAS под root c аутентификацией только по ssh-ключу, запретив на стороне сервера логинить root по его паролю.

	Но нужно ли? Всегда придёт день, когда надо ноутбук с ключами будет недоступен, а на сервер надо будет зайти под рут напрямую с клавиатуры, и будет ой.

===== Формат ssh =====

OMV принимает public key в двух форматах: 
1. OpenSSH (стандарт для утилиты ssh-keygen)
2. RFC 4716

То есть, OMV не примет ключ с крутыми современными алгоритмами вроде ECDSA или ed25519. С одной стороны, увы, с другой стороны — да и незачем.

===== Passphrase =====

При создании ключа следует указать passphrase — кагбэ тоже пароль, но может содержать даже пробелы и быть какой угодно длины.

Пример: “Mother washed window frame for 33 days and#$%&̂ nights long in Hong Kong”.

Можно менять passphrase для существующих ключей. Но невозможно восстановить утерянный passphrase, придётся создать новый ключ.

Можно создать ключ без passphrase.

Когда ключей больше, чем один, есть смысл прописывать к ним внятные камменты при их создании.



//Next step//: 
